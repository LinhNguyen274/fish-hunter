const _G="undefined"==typeof window?global:window,roman_numerals=[{value:1e3,symbol:"M"},{value:900,symbol:"CM"},{value:500,symbol:"D"},{value:400,symbol:"CD"},{value:100,symbol:"C"},{value:90,symbol:"XC"},{value:50,symbol:"L"},{value:40,symbol:"XL"},{value:10,symbol:"X"},{value:9,symbol:"IX"},{value:5,symbol:"V"},{value:4,symbol:"IV"},{value:1,symbol:"I"}],money_formater_arr=[{div:1e9,dex:"B"},{div:1e6,dex:"M"},{div:1e3,dex:"K"}];function money_formater_mechanic(t,e,n){return(t/e).toFixed(1).replace(/\.0$/,"")+n}const dayMMS=864e5;function uuid_generator(){return`${random_character()}_${Date.now()}_${Math.floor(900*Math.random())+100}`}function char_replacer_at(t,e,n){return t.length<=e&&(t=t.padEnd(e," ")),t.substring(0,e)+n+t.substring(e+1)}function random_character(t=!1){const e=26*Math.random()>>0,n=t?Math.random()<.5?65:97:65;return String.fromCharCode(n+e)}class pTween{constructor(){this._memory={}}_quick_opt(t){const e=`__to_num_${Date.now()}_${1e3*Math.random()>>1}`;return{id:"number"==typeof t?e:t.id||e,duration:1e3*("number"==typeof t?t:t.duration||1),step:"number"==typeof t?16:t.step||16,log:"number"!=typeof t&&(t.log||!1)}}stop_tween(...t){for(const e of t)null!=e&&null!=this._memory[e]&&(clearInterval(this._memory[e]),delete this._memory[e])}tween_interval(t,e,n,o){t=this._quick_opt(t),this.stop_tween(t.id);const r=Math.max(1,Math.round(t.duration/t.step));let i=0;return this._memory[t.id]=setInterval(()=>{const c=e(++i,r);n&&n(c),i>=r&&(this.stop_tween(t.id),n&&n(c),o&&o())},t.step),t.id}to_number(t,e,n,o,r){const i=e-t;return this.tween_interval(n,(e,n)=>t+i/n*e,o,r)}spining_text(t,e,n,o){if(null==t)return;e=this._quick_opt(e);const r=t.length,i=e.duration/(r-1)/1e3;let c=0,s="";const a=t=>{s=char_replacer_at(s,c,t),n&&n(s)},l=()=>{a(t[c]),++c>=r?o&&o():this.spining_char({duration:i,key:`__spining_text_${e.key}__`},a,l)};this.spining_char({duration:i,key:`__spining_text_${e.key}__`},a,l)}spining_char(t,e,n){return this.tween_interval(t,random_character,e,n)}}class pSignal{constructor(){this._container={}}add(t,e,...n){const o={},r=[e,...n].flat();for(const i of r)o[i.id||uuid_generator()]="function"==typeof i?i:i.method;return this._container[t]={...this._container[t],...o},Object.keys(o)}invoke(t,e=null,...n){const o=this._container[t];if(!o)return;const r={};for(const[i,c]of Object.entries(o))r[i]=c();return r}invokes(t,e,...n){const o={};for(const r of t)o[r]=this.invoke(r,e,...n);return o}removes(t,e,...n){const o=this._container[t];if(!o)return;const r=[e,...n].flat();for(const i of r)delete o[i]}clean(t){delete this._container[t]}}class pTSHelper{constructor(){this.random_character=random_character,this.uuid_generator=uuid_generator,this.char_replacer_at=char_replacer_at,this.builtin={},this.fxc={},this.signal=new pSignal,this.tween=new pTween}add_click_event_for_button(t,e,n,o,r){const i=e.getComponent(n);if(!i)return;if(!Object.getOwnPropertyNames(i.constructor.prototype).includes(o))return;const c=new cc.Component.EventHandler;c.target=e,c.component="string"==typeof n?n:cc.js.getClassName(i),c.handler=o,c.customEventData=r,t.clickEvents.push(c)}set_click_event_for_button(t,e,n,o,r){t.clickEvents=[],this.add_click_event_for_button(t,e,n,o,r)}is_vec2_equal(t,e){return t.x==e.x&&t.y===e.y}is_vec3_equal(t,e){return t.x==e.x&&t.y===e.y&&t.z===e.z}get_local_position(t,e){if(e instanceof cc.Node){if(t.parent===e.parent)return e.position;const n=e.convertToWorldSpaceAR(cc.v3());return t.parent.convertToNodeSpaceAR(n)}return e.is_world_pos?t.parent.convertToNodeSpaceAR(e.position):e.position}set_position(t,e){t.setPosition(this.get_local_position(t,e))}chain_sp_anim(t,e,n){const o=e.length;this.settup_skeleton(t,n);const r=null==n.loop_at_end||n.loop_at_end,i=null!=n.anim_track_id?n.anim_track_id:0;if(o>=2){target.setAnimation(0,e[0],!1);for(let n=0;n<o;n++)n===o-1&&r?t.addAnimation(i,e[n],!0):t.addAnimation(i,e[n],!1)}else t.setAnimation(i,i[0],r)}settup_skeleton(t,e){if(!e||!t)return;const n=null!=e.time_scale?e.time_scale:t.timeScale;t.timeScale=n;const o=e.mixin;o&&o.enable&&this.mixin_skeleton(t,o)}mixin_skeleton(t,e){const n=new sp.spine.AnimationStateData(t.skeletonData.getRuntimeData()),o=null!=e&&null!=e.default_mixin_duration?e.default_mixin_duration:1/6;if(n.defaultMix=o,null!=e&&null!=e.options)for(const r of e.options)n.setMix(r.from,r.to,r.duration);t.setAnimationStateData(n)}get_possible_component(t,...e){for(const n of e){const e=t.getComponent(n);if(e)return e}return null}number_to_short_money(t){for(const e of money_formater_arr)if(t>=e.div)return money_formater_mechanic(t,e.div,e.dex);return t.toString()}en_number(t){return t.toLocaleString("en-US").replace(/,/g,".")}check_component_in_prefab(t,e,n=!1){return!1}to_date_day_num(t){return Math.floor(t/dayMMS)}day_differ(t){return this.to_date_day_num(Date.now())-this.to_date_day_num(t)}random_int(t,e){return t=Math.ceil(t),t=Math.ceil(e),Math.floor(Math.random()*(e-t+1))+t}editbox_binder(t,e,n,o=null){if(!t instanceof cc.EditBox)return;if(!t._impl)return;const r=t._impl._elem;r&&r.addEventListener(e,n,o)}game_focus(){cc.sys.isBrowser&&document.getElementsByTagName("canvas")[0].focus()}children_checker(t,...e){return e.every(e=>!!t.getChildByName(e))}children_checker_detail(t,...e){const n={};for(const o of e){const e=t.getChildByName(o);n[o]=e||null}return n}children_checker_detail_array(t,...e){const n=[];for(const o of e){const e=t.getChildByName(o);n.push({key:o,data:e||null})}return n}number_extractor(t){const e=t.match(/\d+/g);return e?e.map(Number):[]}to_number(t){const e=t.match(/\d+/g);return e?Number(e.join("")):0}find_biggest(t,e){return"string"==typeof e&&t[0].property?t.reduce((t,n)=>n[e]>t[e]?n:t):"function"==typeof e?t.reduce(e):void 0}quick_rect(t,e=!0,n=null){const o=e?t.convertToWorldSpaceAR(cc.v2()):t.position,r=t.getContentSize();if(n){const t=n instanceof cc.Graphics,i=t?n:n.graph,c=!!t||n.is_fill||!0,s=!!t||n.is_fill||!0,a=t?cc.Color.WHITE:n.fill_color?this.quick_color(n.fill_color):cc.Color.WHITE,l=t?cc.Color.WHITE:n.stroke_color?this.quick_color(n.stroke_color):cc.Color.WHITE,_=t?1:n.stroke_width||1,u=i.node,d=e?u.parent.convertToNodeSpaceAR(o):u.parent.convertToNodeSpaceAR(u.convertToWorldSpaceAR(cc.v2()));i.fillColor=a,i.strokeColor=l,i.lineWidth=_,i.rect(d.x-r.width/2,d.y-r.height/2,r.width,r.height),c&&i.fill(),s&&i.stroke()}return cc.rect(o.x-r.width/2,o.y-r.height/2,r.width,r.height)}quick_color(t){return cc.color(t.r,t.g,t.b)}inside_checker(t,e,n=!0){const o=n?t.getBoundingBoxToWorld():this.quick_rect(t);return(n?e.getBoundingBoxToWorld():this.quick_rect(e)).containsRect(o)}to_roman_number(t){t=Math.floor(t);let e="";for(const n of roman_numerals)for(;t>=n.value;)e+=n.symbol,t-=n.value;return e}from_roman_number(t){t=t.toUpperCase();let e=0,n=0;for(;e<t.length;){for(const{value:o,symbol:r}of roman_numerals)if(t.startsWith(r,e)){n+=o,e+=r.length;break}e++}return n}}const ret=new pTSHelper;_G.pTS=ret,cc._opts={loading:{is:!1,__cbs:[],end:function(){this.is=!1;for(const t of this.__cbs)t&&t();this.__cbs=[]},add_callback_on_done:function(t,...e){if("function"==typeof t)this.__cbs.push(t);else if(Array.isArray(t))for(const n of t)this.__cbs.push(n);for(const n of e)this.__cbs.push(n)},start:function(){this.is=!0,this.__cbs=[]}}},cc.EditBox.Events={begin_editing:"editing-did-began",end_editing:"editing-did-ended",on_editing:"text-changed",return:"editing-return"};